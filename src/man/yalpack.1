.\" Manpage for yalpack
.\" Contact (kvngncrlsn@gmail.com) to correct errors or typos.
.TH man 1 "10 September 2021" "0.2.0" "yalpack man page"
.SH NAME
.B yalpack
\(em a basic POSIX-compliant package management solution for LFS/BLFS systems
.SH DESCRIPTION
.B yalpack
is a collection of man pages and POSIX-compliant scripts intended to make managing packages more convenient on
.B Linux From Scratch\fR\
-based systems, particularly with respect to removing and upgrading packages, managing .new files and tracking dynamic library usage.
.SH BASIC OPERATIONS
It is not necessary to know how to operate every script to get started with
.B yalpack\fR\
. The following basic commands are good to know:

.B \t make package
.br
Run this command in the
.B yalpack
source directory to install or upgrade
.B yalpack
as a package. For upgrades, the new versions of all scripts will be used. This is the recommended method for all installations and upgrades of
.B yalpack\fR\
\&.

.B \t pkgmake [NAME]-[VERSION]
.br
.B pkgmake(1)
will take compiled software in
.I /tmp/[NAME]-[VERSION]/dest
and turn it into a
.B yalpack
package. A
.I NAME
file with the package's name should be in the top part of the directory.

.B \t pkginst [NAME]-[VERSION]
.br
Install a package over the root directory after evaluating .new files and repairing absolute symlinks. Perform package checks.

.B \t pkgup [NAME] [NAME]-[NEWVERSION]
.br
Upgrade a package, removing extraneous files, etc.

.B \t pkgremove [NAME]
.br
Remove a package from the system with any extraneous files.

These commands should be more than enough to get package management with
.B yalpack
off the ground. For tips about building software to be managed with
.B yalpack\fR\
, see
.I /usr/share/doc/yalpack-0.2.0/README\fR\
\&.
.SH SCRIPTS
The following root-use scripts are installed by
.B yalpack\fR\
:

.B \t /usr/sbin/pkgmake
.br
.B \t
Turning compiled software into a
.B yalpack
package, ready to be installed.

.B \t /usr/sbin/pkginst
.br
.B \t
Installing
.B yalpack\fR\
-built packages.

.B \t /usr/sbin/pkgremove 
.br
.B \t
Removing
.B yalpack\fR\
-built packages.

.B \t /usr/sbin/pkgup 
.br
.B \t
Upgrading
.B yalpack\fR\
-built packages.

.B \t /usr/sbin/pkgcheck 
.br
.B \t
Checking and updating information about
.B yalpack\fR\
-built packages.

.B \t /usr/sbin/liblist
.br
.B \t
Generating dynamic library usage information for binaries.

.B \t /usr/share/yalpack/restore-yalpack 
.br
.B \t
Regenerate the
.B yalpack
data directory from a good package tree backup.

.B \t /usr/share/yalpack/newfiles
.br
.B \t
Update, list and manage .new files belonging to
.B yalpack\fR\
-installed packages.

.B \t /usr/share/yalpack/backups
.br
.B \t
Generate backup package trees in a new location.

Another set of utility scripts is available for non-root users:

.B \t /usr/bin/pkglist
.br
.B \t
Show a list of installed packages with their version numbers (regex searching available).

.B \t /usr/bin/libcheck
.br
.B \t
Return installation and usage information for libraries matching a search term.

.B \t /usr/bin/yalfind
.br
.B \t
Determine which
.B yalpack\fR\
-installed package provides a given file, directory or symlink.
.SH DIRECTORIES
The main
.B yalpack
data directory can be found at
.I /var/yalpack\fR\
\&. It contains the following subdirectories:

.I \t BIN-DEPS
.br
.I \t BIN-DEPS.old
.br
.I \t packages
.br
.I \t pkgdata
.SH /var/yalpack/BIN-DEPS
.I BIN-DEPS
contains
.B ldd(1)\fR\
-derived library usage information for every binary on the system that uses dynamic libraries. It is organized into subdirectories, one for each binary. These subdirectories contain a document entitled
.I NAME.libinfo
with the library information (e.g., 
.I /var/yalpack/BIN-DEPS/grep/grep.libinfo\fR\
).

Whenever
.B liblist(1)
is run, the existing
.I BIN-DEPS
directory (if any) is saved under
.I BIN-DEPS.old\fR\
\&.
.SH /var/yalpack/packages
This is the staging area for installing packages packaged by pkgmake(1). Temporary files and subdirectories are made and removed here during the package upgrade and installation process.
.SH /var/yalpack/pkgdata
Where most of the information about
.B yalpack\fR\
-installed packages is stored. It has the following subdirectories:

.I \t NEWFILES
.br
.B \t
Contains documents with \(lq.new\(rq files (if any) installed to the system on a per-package basis. It is regenerated whenever
.I /usr/share/yalpack/newfiles
is run.

.I \t PKG-BINS
.br
.B \t
Contains a list of installed executable files for each package.

.I \t PKG-DEPS
.br
.B \t
Contains a list of dynamic libraries used on a per-package basis.

.I \t PKG-LIBS
.br
.B \t
Shows the libraries installed by each package.

.I \t SYMTREES
.br
.B \t
Has per-package lists of files installed under a path containing symlinks. This is mostly relevant for systems beyond
.B LFS 10.1\fR\
, which have merged-usr setups.
.br
.B \t
For earlier versions of LFS (i.e., those with genuine
.I /bin\fR\
,
.I /sbin
and
.I /lib
directories), the presence of a
.I SYMTREE
file may be an indication that a package was built incorrectly.

.I \t TREES
.br
.B \t
.I TREES
contains a package tree document for each package.

.I \t VER
.br
.B \t
Every
.B yalpack\fR\
-installed package leaves a file with the version number, if any, in
.I VER
upon installation.
.SH MAN PAGES
.B yalpack
comes with the following man pages:

.B \t pkgmake(1)
.br
.B \t pkginst(1)
.br
.B \t pkglist(1)
.br
.B \t pkgremove(1)
.br
.B \t pkgup(1)
.br
.B \t pkgcheck(1)
.br
.B \t liblist(1)
.br
.B \t libcheck(1)
.br
.B \t restore-yalpack(8)
.br
.B \t newfiles-yalpack(8)
.br
.B \t yalfind(1)

.SH CAUTIONS
.B yalpack-0.2.0
has been tested with
.B LFS 11.0\fR\
; it has been verified not to remove the
.I /bin\fR\
,
.I /sbin
or
.I /lib
symlinks for merged-usr systems. It has not been (and most likely will not be) tested with previous versions of
.B Linux From Scratch\fR\
.

Because some
.B yalpack
scripts call
.B ldd(1)
to check dynamic library usage,
.B yalpack
should not be used with
.B glibc-2.26
or earlier versions. See the \(lqSecurity\(rq section in
.B ldd(1)
for a detailed explanation.

.B yalpack
can be used at any point once the LFS system is in chroot or independent boot. Never use
.B yalpack
on the \(lqhost\(rq system.
.SH SEE ALSO
The man pages for the scripts listed above; in addition,
.B ldd(1)
and the contents of
.I /usr/share/doc/yalpack-0.2.0\fR\
\&.

For information about the variables in
.I /etc/yalpack.conf\fR\
, see the explanatory comments in that file or
.I /usr/share/doc/yalpack-0.2.0/Customization\fR\
\&.

Visit
.B yalpack\fR\
\&'s home on GitHub to see future plans, report bugs or download the latest release:
.UR https://github.com/pghvlaans/yalpack
.UE . A \(lqdev\(rq branch is intermittently available.
.SH BUG REPORTING
Submit a GitHub issue, or contact the author directly by email.
.SH AUTHOR
K. Eugene Carlson
.MT kvngncrlsn@gmail.com
.ME
